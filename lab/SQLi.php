<html>
<head>
  <title> SQLi njection </title>
</head>
<body>
<?php
////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////
// Gandalf@localhost [phplabs]> SELECT * FROM users;
// +----+----------+--------------------+---------------------+
// | id | username | email              | reg_date            |
// +----+----------+--------------------+---------------------+
// |  1 | root     | root@example.com   | 2024-10-17 02:36:20 |
// |  2 | dragon   | player@example.com | 2024-10-17 02:32:36 |
// +----+----------+--------------------+---------------------+
// 2 rows in set (0.000 sec)
////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////
/* SQLconnection
 *  Open a new connection to the MySQL server 
 *  - usr: user
 *  - pwd: password
 *  - db:  database 
 *//////////////////////////////////////////////////////////
$OCKS = 3;
function SQLconnection( $usr, $pwd, $db ){
    try {
        $conn = new mysqli( "localhost", $usr, $pwd, $db );
    } catch( Exception $e ){
        echo $e;    
        exit( $OCKS );
    }
    return $conn;
}
////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////
// > php -S localhost:8000
////////////////////////////////////////////////////////////
// http://localhost:8000/SQLi.php?username="" OR 0 = 0
////////////////////////////////////////////////////////////
// SELECT * FROM users WHERE username = "" OR 0 = 0
// ID: 1 - Username: root - Email: root@example.com
// ID: 2 - Username: dragon - Email: player@example.com
////////////////////////////////////////////////////////////
function SQLi() {
    $usr = getenv('DRAGONPLAYER');
    $pwd = getenv('QUEENCAPTURE');
    $db = "phplabs";
    $conn = SQLconnection( $usr, $pwd, $db );
    $sql = "SELECT * " . 
           "FROM users " . 
           "WHERE username = " . $_GET[ "username" ];
    echo $sql . '<br>';
    $result = $conn->query( $sql );
    if( $result->num_rows > 0 ){
        while( $row = $result->fetch_assoc()){
            echo "ID: " . 
                 $row["id"] . 
                 " - Username: " . 
                 $row["username"] . 
                 " - Email: " . 
                 $row["email"] . 
                 "<br>";
        }
    } else {
        echo "No results found";
    }
}
////////////////////////////////////////////////////////////
SQLi();
////////////////////////////////////////////////////////////
// Usage: - Boyo hun, moyo hun nele neray, that harmonic? ..
// NATA DAGA TIRE!
// - Then I should die as one of them( leaves the room )
// - .. let him be
////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////
?>
</body>
</html>
